<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carrousel Accessible</title>
  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <style>
    body {
      background: #f5f5f5;
    }
    .carousel-outer {
      max-width: 1200px;
      margin: 2rem auto;
      background: #f6f3f0;
      border-radius: 0;
      display: flex;
      min-height: 600px;
      box-shadow: 0 2px 8px #0001;
      overflow: hidden;
    }
    .carousel-content {
      flex: 1 1 50%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 4rem 3rem 4rem 6rem;
      background: #f6f3f0;
    }
    .carousel-title {
      font-size: 4rem;
      font-weight: 500;
      margin: 0 0 2rem 0;
      line-height: 1;
      letter-spacing: -0.04em;
    }
    .carousel-desc {
      font-size: 1.2rem;
      color: #222;
      line-height: 1.5;
      margin-bottom: 2rem;
    }
    .carousel-img-container {
      flex: 1 1 50%;
      position: relative;
      min-width: 0;
      min-height: 400px;
      background: #eee;
      display: flex;
      align-items: stretch;
      justify-content: stretch;
    }
    .carousel-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 0;
    }
    .carousel-arrow {
      position: absolute;
      top: 2rem;
      right: 3.5rem;
      background: rgba(255,255,255,0.3);
      border: none;
      color: #222;
      font-size: 1.5rem; /* petit */
      cursor: pointer;
      z-index: 2;
      transition: color 0.2s, background 0.2s;
      padding: 0.2em 0.4em;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 50%;
      box-shadow: 0 2px 8px #0002;
    }
    .carousel-arrow.left {
      right: 6.5rem;
      left: auto;
    }
    .carousel-arrow:focus {
      outline: 2px solid #1976d2;
      color: #1976d2;
      background: rgba(255,255,255,0.6);
    }
    .carousel-dots {
      display: flex;
      justify-content: center;
      gap: 1em;
      margin-top: 2.5rem;
    }
    .carousel-dot {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      width: 24px;
      height: 24px;
      position: relative;
      outline: none;
    }
    .carousel-dot:focus-visible {
      outline: 2px solid #1976d2;
      outline-offset: 2px;
    }
    .carousel-dot .dot-outer {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 2px solid #222;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255,255,255,0.7);
      box-sizing: border-box;
      transition: border-color 0.2s;
    }
    .carousel-dot.active .dot-outer {
      border-color: #1976d2;
    }
    .carousel-dot .dot-inner {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #1976d2;
      display: none;
      transition: background 0.2s;
    }
    .carousel-dot.active .dot-inner {
      display: block;
    }
    @media (max-width: 900px) {
      .carousel-outer {
        flex-direction: column;
        min-height: 0;
      }
      .carousel-content {
        padding: 2rem 1.5rem;
      }
      .carousel-img-container {
        min-height: 250px;
        height: 250px;
      }
      .carousel-title {
        font-size: 2.5rem;
      }
      .carousel-arrow {
        top: 1rem;
        right: 2.5rem;
        font-size: 1.2rem; /* petit */
      }
      .carousel-arrow.left {
        right: 5rem;
      }
    }

    .carousel-arrow:focus {
        outline: 3px solid #fff;      /* Blanc per fora */
        outline-offset: 2px;
        box-shadow: 0 0 0 4px #000;   /* Negre per dins */
        color: #222;
        background: rgba(255,255,255,0.6);
    }

    .cards-exemples {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 2rem;
      margin: 2rem 0;
    }
    .card {
      background: #fff;
      border-radius: 0.5rem;
      padding: 1.5rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 0;
    }
    .card h3 {
      font-size: 1.5rem;
      margin: 0 0 1rem 0;
    }
    .code-box {
      background: #f4f4f4;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 1rem;
      margin: 1rem 0 0.5rem 0;
      font-family: 'Courier New', Courier, monospace;
      font-size: 0.95rem;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-left">
      <a class="btn-back" href="../inici.html" aria-label="Torna enrere">
        <i class="fas fa-arrow-left"></i>
      </a>
      <h1>Exemples de Slider</h1>
    </div>
    <nav>
      <ul class="nav-bar">
        <li><a href="../components/cards.html">Cards</a></li>
        <li><a href="../components/buttons.html">Botons</a></li>
        <li><a href="../components/events.html">Events</a></li>
        <li><a href="../components/llistes.html">Llistes</a></li>
        <li><a href="../components/slider.html">Slider</a></li>
        <li><a href="../components/carrousel.html">Carousel</a></li>
      </ul>
    </nav>
  </header>

  <main>
  <section class="card" style="max-width:700px;margin:2rem auto;">
    <h2 style="margin-top:0;">Carrousel Accessible: atributs i funcions clau</h2>
    <div class="cards-exemples" style="display:block;">
      <div>
        <h3>Atributs importants</h3>
        <div class="code-box" style="margin-bottom:1rem;"><code>&lt;section class="carousel-outer" aria-label="Carrousel de botigues" id="carousel" tabindex="0"&gt;
  ...
  &lt;button class="carousel-arrow left" id="carousel-prev" aria-label="Anterior"&gt;&lt;/button&gt;<
  &lt;img class="carousel-img" id="carousel-img" src="" alt="" /&gt;
  &lt;button class="carousel-arrow" id="carousel-next" aria-label="Següent"&gt;&lt;/button&gt;
&lt;/section&gt;</code></div>
        <ul>
          <li><b>aria-label</b>: Descriu el propòsit del carrousel i dels botons.</li>
          <li><b>tabindex="0"</b>: Permet el focus per teclat a la secció.</li>
          <li><b>alt</b>: Text alternatiu per a la imatge.</li>
        </ul>
      </div>
      <div style="margin-top:2rem;">
        <h3>Funcions JavaScript clau</h3>
        <div class="code-box" style="margin-bottom:1rem;"><code>// Renderitza la diapositiva actual
function renderSlide(idx, focus = false) { ... }<br>
// Navegació amb botons
prevBtn.addEventListener('click', ...);
nextBtn.addEventListener('click', ...);<br>
// Navegació amb teclat
carouselSection.addEventListener('keydown', ...);</code></div>
        <ul>
          <li><b>renderSlide(idx, focus)</b>: Actualitza el contingut i el focus.</li>
          <li><b>addEventListener('keydown')</b>: Permet la navegació amb fletxes, Home i End.</li>
        </ul>
      </div>
    </div>
  </section>

    <section class="carousel-outer" aria-label="Carrousel de botigues" id="carousel" tabindex="0">
      <div class="carousel-content">
        <h2 class="carousel-title" id="carousel-title"></h2>
        <p class="carousel-desc" id="carousel-desc"></p>
        <div class="carousel-dots" id="carousel-dots" aria-label="Selecció de diapositiva"></div>
        <!-- Afegim un live region per anunciar canvis -->
        <div id="carousel-live" class="sr-only" aria-live="polite" aria-atomic="true"></div>
      </div>
      <div class="carousel-img-container">
        <button class="carousel-arrow left" id="carousel-prev" aria-label="Anterior">
          <i class="fas fa-chevron-left"></i>
        </button>
        <img class="carousel-img" id="carousel-img" src="" alt="" />
        <button class="carousel-arrow" id="carousel-next" aria-label="Següent">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </section>
  </main>
  <script>
    // Dades d'exemple (tot en català)
    const carouselSlides = [
      {
        title: "Flagship<br>Lió",
        desc: "La nova botiga de Kave Home a Lió se situa entre la riba tranquil·la del Roine i el bullici de la plaça Bellecour, dins del Grand Hôtel-Dieu. L'espai fusiona el bagatge cultural del monument històric on es troba, un edifici reconegut com a Patrimoni Mundial per la UNESCO, amb la nostra essència mediterrània. Les finestres situades sota les majestuoses cúpules deixen passar la llum, enaltint els materials naturals i les tonalitats de les nostres peces.",
        img: "https://d.media.kavehome.com/image/upload/w_1200,ar_1.91,c_fill,g_auto,b_rgb:F0EFEB/stores/S0022/lyon_01.jpg",
        alt: "Façana de la botiga Kave Home a Lió amb grans arcs i decoració nadalenca"
      },
      {
        title: "Flagship<br>Barcelona",
        desc: "La botiga de Barcelona és un espai vibrant situat al cor de la ciutat, on la llum natural i el disseny mediterrani es fusionen per crear una experiència única.",
        img: "https://media.timeout.com/images/105394374/image.jpg",
        alt: "Interior de la botiga Kave Home a Barcelona amb mobles moderns"
      },
      {
        title: "Flagship<br>Madrid",
        desc: "Descobreix la nostra botiga a Madrid, un espai on la tradició i la modernitat conviuen en harmonia, amb una selecció exclusiva de peces de disseny.",
        img: "https://www.distribucionactualidad.com/wp-content/uploads/2024/03/KAVE-HOME-HERMOSILLA_fachada.jpg",
        alt: "Entrada de la botiga Kave Home a Madrid amb decoració elegant"
      }
    ];

    let current = 0;

    const titleEl = document.getElementById('carousel-title');
    const descEl = document.getElementById('carousel-desc');
    const imgEl = document.getElementById('carousel-img');
    const dotsEl = document.getElementById('carousel-dots');
    const prevBtn = document.getElementById('carousel-prev');
    const nextBtn = document.getElementById('carousel-next');
    const carouselSection = document.getElementById('carousel');
    const liveRegion = document.getElementById('carousel-live');

    function renderSlide(idx, focus = false) {
        // Actualitza títol, descripció i imatge
        const slide = carouselSlides[idx];
        titleEl.innerHTML = slide.title;
        descEl.textContent = slide.desc;
        imgEl.src = slide.img;
        imgEl.alt = slide.alt;

        // Actualitza el focus a la imatge si focus = true (per accessibilitat)
        if (focus) {
            carouselSection.focus();
        }

        // Dots accessibles
        dotsEl.innerHTML = '';
        let dotToFocus = null;
        carouselSlides.forEach((slide, i) => {
            const dot = document.createElement('button');
            dot.className = 'carousel-dot' + (i === idx ? ' active' : '');
            dot.setAttribute('aria-label', `Ves a la diapositiva ${i + 1}`);
            dot.setAttribute('aria-current', i === idx ? 'true' : 'false');
            dot.innerHTML = `
            <span class="dot-outer">
                <span class="dot-inner"></span>
                <span class="sr-only">
                ${i + 1}${i === idx ? ' (Diapositiva actual)' : ''}
                </span>
            </span>
            `;
            dot.addEventListener('click', () => {
                current = i;
                renderSlide(current, false);
            });
            dot.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                current = i;
                renderSlide(current, true); // focus = true
                e.preventDefault();
            }
            });
            dotsEl.appendChild(dot);
            if (i === idx) dotToFocus = dot;
        });

        // Anuncia el canvi de contingut per a lectors de pantalla
        if (liveRegion) {
          // Força l'anunci reiniciant el node (truc per a NVDA/JAWS/VoiceOver)
          liveRegion.textContent = '';
          setTimeout(() => {
            // Mostra "Diapositiva x de y"
            liveRegion.textContent = `Diapositiva ${idx + 1} de ${carouselSlides.length}`;
          }, 10);
        }

        // No canvies el focus automàticament!
    }

    prevBtn.addEventListener('click', () => {
        current = (current - 1 + carouselSlides.length) % carouselSlides.length;
        renderSlide(current, false); // focus = false
        // No canvies el focus aquí
    });
    nextBtn.addEventListener('click', () => {
        current = (current + 1) % carouselSlides.length;
        renderSlide(current, false); // focus = false
        // No canvies el focus aquí
    });

    carouselSection.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') {
            current = (current - 1 + carouselSlides.length) % carouselSlides.length;
            renderSlide(current, false);
            prevBtn.focus();
            e.preventDefault();
        } else if (e.key === 'ArrowRight') {
            current = (current + 1) % carouselSlides.length;
            renderSlide(current, false);
            nextBtn.focus();
            e.preventDefault();
        } else if (e.key === 'Home') {
            current = 0;
            renderSlide(current, true); // focus = true
            e.preventDefault();
        } else if (e.key === 'End') {
            current = carouselSlides.length - 1;
            renderSlide(current, true); // focus = true
            e.preventDefault();
        }
    });

    // Inicialització
    renderSlide(current);

    // Accessibilitat: focus visible a la secció
    carouselSection.setAttribute('tabindex', '0');
  </script>
</body>
</html>
